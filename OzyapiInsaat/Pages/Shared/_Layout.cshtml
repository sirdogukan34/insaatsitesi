@using OzyapiInsaat.Data
@using Microsoft.EntityFrameworkCore
@inject ApplicationDbContext DbContext

@{
    var settings = DbContext.SiteSettings.AsNoTracking().FirstOrDefault() ?? new OzyapiInsaat.Models.SiteSettings();
    var contact = DbContext.ContactInfo.AsNoTracking().FirstOrDefault() ?? new OzyapiInsaat.Models.ContactInfo();
    var isAuthenticated = User.Identity?.IsAuthenticated ?? false;
}

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"] - Özyapı İnşaat</title>
    <link rel="icon" href="@settings.FaviconUrl" type="image/x-icon" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Custom CSS -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        .hero-bg {
            background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://images.unsplash.com/photo-1541888946425-d81bb19240f5?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
        }

        .whatsapp-fab {
            position: fixed;
            width: 60px;
            height: 60px;
            bottom: 40px;
            right: 40px;
            background-color: #25D366;
            color: #FFF;
            border-radius: 50px;
            text-align: center;
            font-size: 30px;
            box-shadow: 2px 2px 3px #999;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Header & Navigation -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="/" class="text-2xl font-bold text-gray-900">
                @if (!string.IsNullOrEmpty(settings.LogoUrl))
                {
                    <img src="@settings.LogoUrl" alt="Site Logosu" class="h-10">
                }
                else
                {
                    <span><i class="fas fa-building text-orange-500"></i> Özyapı <span class="text-orange-500">İnşaat</span></span>
                }
            </a>
            <div class="hidden md:flex space-x-8 items-center">
                <a href="/#hizmetler" class="text-gray-600 hover:text-orange-500 transition duration-300">Hizmetlerimiz</a>
                <a href="/#projeler" class="text-gray-600 hover:text-orange-500 transition duration-300">Projelerimiz</a>
                <a href="/#hakkimizda" class="text-gray-600 hover:text-orange-500 transition duration-300">Hakkımızda</a>
                <a href="/#iletisim" class="bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600 transition duration-300">Teklif Alın</a>
                @if (isAuthenticated)
                {
                    <a href="/Admin/Panel" class="text-blue-600 hover:text-blue-800 transition duration-300">Yönetim Paneli</a>
                }
            </div>
            <button id="mobile-menu-button" class="md:hidden">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
            <a href="/#hizmetler" class="block py-2 text-gray-600 hover:text-orange-500">Hizmetlerimiz</a>
            <a href="/#projeler" class="block py-2 text-gray-600 hover:text-orange-500">Projelerimiz</a>
            <a href="/#hakkimizda" class="block py-2 text-gray-600 hover:text-orange-500">Hakkımızda</a>
            <a href="/#iletisim" class="block mt-2 bg-orange-500 text-white text-center px-4 py-2 rounded-md hover:bg-orange-600">Teklif Alın</a>
            @if (isAuthenticated)
            {
                <a href="/Admin/Panel" class="block mt-2 bg-blue-500 text-white text-center px-4 py-2 rounded-md hover:bg-blue-600">Yönetim Paneli</a>
            }
        </div>
    </header>

    <div>
        @RenderBody()
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6 text-center">
            <p>@settings.FooterCopyright</p>
            <p class="text-gray-400 text-sm mt-1">@settings.FooterTagline</p>
        </div>
    </footer>

    <!-- WhatsApp FAB -->
    @if (!string.IsNullOrEmpty(contact.WhatsAppNumber))
    {
        <a href="https://wa.me/@contact.WhatsAppNumber?text=Merhaba,%20web%20siteniz%20üzerinden%20ulaşıyorum."
           class="whatsapp-fab"
           target="_blank"
           aria-label="WhatsApp ile İletişime Geçin">
            <i class="fab fa-whatsapp"></i>
        </a>
    }

    <script>
        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');

        if (mobileMenuButton) {
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }
    </script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
